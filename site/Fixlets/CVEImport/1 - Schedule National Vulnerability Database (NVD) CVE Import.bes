<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Task>
		<Title>Schedule National Vulnerability Database (NVD) CVE Import</Title>
		<Description><![CDATA[<P style="MARGIN-RIGHT: 0px" dir=ltr><STRONG><FONT size=3>Information</FONT></STRONG> </P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<P>This task is used to schedule periodical National Vulnerability Database (NVD) CVE data import. The default action is to run the import once a day, but that can be changed as desired.</P>
<P>The utility uses the IBM BigFix REST API to import data into the BigFix Server.</P>
<P>This Task uses the secure parameters feaure to ensure that the credentails entered below are protected. The parameters are encrypted and delivered to the targeted endpoint mailbox. Only the targeted endpoint can access the parameters.</P></BLOCKQUOTE>
<P style="MARGIN-RIGHT: 0px" dir=ltr><STRONG><FONT size=3>Enter the following required parameters</FONT></STRONG> </P>
<BLOCKQUOTE style="MARGIN-RIGHT: 0px" dir=ltr>
<TABLE>
<TBODY>
<TR>
<TD><LABEL for=server>BigFix Root Server (FQDN or IP address):</LABEL></TD>
<TD><INPUT id=server name=server></TD></TR>
<TR>
<TD><LABEL for=port>BigFix Root Server Port:</LABEL></TD>
<TD><INPUT id=port name=port></TD></TR>
<TR>
<TD><LABEL for=username>Username:</LABEL></TD>
<TD><INPUT id=username name=username></TD></TR>
<TR>
<TD><LABEL for=pwd>Password:</LABEL></TD>
<TD><INPUT id=pwd type=password name=pwd></TD></TR></TBODY></TABLE></BLOCKQUOTE><script>
			   document.body.ontakeaction = function() {
					var theServer 	= document.getElementById( "server" ).value;
					var thePort		= document.getElementById( "port" ).value;
					var theUsername = document.getElementById( "username" ).value;
					var thePwd 		= document.getElementById( "pwd" ).value;
					
					if (theServer == null || theServer == "")
					{	alert("Please enter the BigFix Server which is required"); }
					else if (thePort == null || thePort == "")
					{	alert("Please enter the BigFix Server Port which is required"); }
					else if (theUsername == null || theUsername == "")
					{	alert("Please enter the Username which is required"); }
					else if (thePwd == null || thePwd == "")
					{	alert("Please enter the Password which is required"); }
					else
					{
						TakeSecureFixletAction( 
							Relevance('id of current fixlet'), 
							Relevance('id of current bes site'), 
							"Action1", {}, { 
								server: theServer,
								port: thePort,
								pwd: thePwd,
								username : theUsername
							} );
					}
					return false;
			   }
			</script> ]]></Description>
		<Relevance>(name of it contains "Win") of operating system</Relevance>
		<Relevance>exists key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full" of registry</Relevance>
		<Category>Imports</Category>
		<DownloadSize>137560</DownloadSize>
		<Source>IBM</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2017-10-09</SourceReleaseDate>
		<SourceSeverity>Required</SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-source</Name>
			<Value>IBM</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Tue, 31 May 2016 23:56:22 +0000</Value>
		</MIMEField>
		<Domain>BESC</Domain>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here </Link>
				<PostLink>to schedule the import.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">download http://syncbf.xforce.ibmcloud.com/bfsites/cvedashboard_5/bigfix_cve_util.exe

delete __appendfile
delete cveimport.bat

appendfile @echo off
appendfile set cve_util_cre={parameter "pwd" of action}
appendfile md cve
appendfile copy __Download\bigfix_cve_util.exe cve\bigfix_cve_util.exe
appendfile cd cve
appendfile bigfix_cve_util.exe -server={parameter "server" of action} -port={parameter "port" of action} -username={parameter "username" of action}
move __appendfile cveimport.bat
runhidden cmd /c cveimport.bat

pause while { not exists process whose (name of it = "bigfix_cve_util.exe") }
delete cveimport.bat

</ActionScript>
			<SuccessCriteria Option="RunToCompletion"></SuccessCriteria>
			<Settings>
				<PreActionShowUI>false</PreActionShowUI>
				<HasRunningMessage>false</HasRunningMessage>
				<HasTimeRange>false</HasTimeRange>
				<HasStartTime>false</HasStartTime>
				<HasEndTime>false</HasEndTime>
				<HasDayOfWeekConstraint>false</HasDayOfWeekConstraint>
				<UseUTCTime>false</UseUTCTime>
				<ActiveUserRequirement>NoRequirement</ActiveUserRequirement>
				<ActiveUserType>AllUsers</ActiveUserType>
				<HasWhose>false</HasWhose>
				<PreActionCacheDownload>false</PreActionCacheDownload>
				<Reapply>true</Reapply>
				<HasReapplyLimit>false</HasReapplyLimit>
				<HasReapplyInterval>true</HasReapplyInterval>
				<ReapplyInterval>P1D</ReapplyInterval>
				<HasRetry>true</HasRetry>
				<RetryCount>99</RetryCount>
				<RetryWait Behavior="WaitForInterval">PT1H</RetryWait>
				<HasTemporalDistribution>false</HasTemporalDistribution>
				<ContinueOnErrors>true</ContinueOnErrors>
				<PostActionBehavior Behavior="Nothing"></PostActionBehavior>
				<IsOffer>false</IsOffer>
			</Settings>
			<SettingsLocks>
				<ActionUITitle>false</ActionUITitle>
				<PreActionShowUI>false</PreActionShowUI>
				<PreAction>
					<Text>false</Text>
					<AskToSaveWork>false</AskToSaveWork>
					<ShowActionButton>false</ShowActionButton>
					<ShowCancelButton>false</ShowCancelButton>
					<DeadlineBehavior>false</DeadlineBehavior>
					<ShowConfirmation>false</ShowConfirmation>
				</PreAction>
				<HasRunningMessage>false</HasRunningMessage>
				<RunningMessage>
					<Text>false</Text>
				</RunningMessage>
				<TimeRange>false</TimeRange>
				<StartDateTimeOffset>false</StartDateTimeOffset>
				<EndDateTimeOffset>false</EndDateTimeOffset>
				<DayOfWeekConstraint>false</DayOfWeekConstraint>
				<ActiveUserRequirement>false</ActiveUserRequirement>
				<ActiveUserType>false</ActiveUserType>
				<Whose>false</Whose>
				<PreActionCacheDownload>false</PreActionCacheDownload>
				<Reapply>false</Reapply>
				<ReapplyLimit>false</ReapplyLimit>
				<RetryCount>false</RetryCount>
				<RetryWait>false</RetryWait>
				<TemporalDistribution>false</TemporalDistribution>
				<ContinueOnErrors>false</ContinueOnErrors>
				<PostActionBehavior>
					<Behavior>false</Behavior>
					<AllowCancel>false</AllowCancel>
					<Deadline>false</Deadline>
					<Title>false</Title>
					<Text>false</Text>
				</PostActionBehavior>
				<IsOffer>false</IsOffer>
				<AnnounceOffer>false</AnnounceOffer>
				<OfferCategory>false</OfferCategory>
				<OfferDescriptionHTML>false</OfferDescriptionHTML>
			</SettingsLocks>
		</DefaultAction>
	</Task>
</BES>
